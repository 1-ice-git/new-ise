@model NewISE.Models.DBModel.ConiugeModel
@*modelFigli NewISE.Models.DBModel.FigliModel*@



@using System.Collections.Generic
@using System.Web.Optimization

<link href="~/Content/css/NuovoConiuge.css" rel="stylesheet" />
<script src="~/Scripts/globalize.0.1.3/globalize.js"></script>
<script src="~/Scripts/globalize.0.1.3/cultures/globalize.culture.it-IT.js"></script>

@{

    decimal idMaggiorazioniFamiliari = Convert.ToDecimal(ViewData["idMaggiorazioniFamiliari"]);
    var errori = ViewData.ModelState;

}

@using (@Ajax.BeginForm("InserisciFamiliare", "VariazioneMaggiorazioniFamiliari", new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "tabFamiliari", OnFailure = "ErroreElaborazioneAjax" }, new { id = "formNewFamiliare" }))
{
    @Html.AntiForgeryToken()
    <div style="padding-left:15px;padding-right:35px">
        <div class="form-horizontal">

            <h4>Nuovo Familiare</h4>
            <hr />

            @Html.Hidden("idMaggiorazioniFamiliari", idMaggiorazioniFamiliari)


            <div class="panel panel-body" style="padding-left:5px; padding-right:5px; margin-right:10px; margin-top:5px;">
                <div class="form-group">

                    <div id="divCombo" class="col-xs-4">
                        @Html.Label("Tipo Familiare", htmlAttributes: new { @class = "control-label" })
                        <div class="select2-container select2-container--classic">
                            @Html.DropDownList("lTipologiaFamiliare", ViewBag.lTipologiaFamiliare as IEnumerable<SelectListItem>, new { @class = "form-control select2 select2-select", @onchange = "NuovoFamiliare();", @onclick = "NuovoFamiliare();" })
                        </div>
                    </div>
                </div>

                <div class="col-xs-8">
                    <div id="divNuovoFamiliare">

                    </div>
                </div>
            </div>

        </div>
    </div>
}



<p style="padding-left: 15px;">
    @*@Ajax.ActionLink("Torna indietro", "ElencoFamiliari", "VariazioneMaggiorazioniFamiliari", new { idMaggiorazioniFamiliari = idMaggiorazioniFamiliari }, new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "tabFamiliari", OnFailure = "ErroreElaborazioneAjax", InsertionMode = InsertionMode.Replace })*@
</p>

<script type="text/javascript">

    function NuovoFamiliare() {
        //debugger;
        var tipofamiliare = $("#lTipologiaFamiliare").val();
        var idMaggiorazioniFamiliari = $("#idMaggiorazioniFamiliari").val();

        if (tipofamiliare == 1)
        {
            var rotta = "/VariazioneMaggiorazioniFamiliari/NuovoConiuge";
        }
        if (tipofamiliare != "" && tipofamiliare != undefined) {
            $.ajax({
                type: "POST",
                url: rotta,
                data: { idMaggiorazioniFamiliari: idMaggiorazioniFamiliari },
                dataType: 'html',
                beforeSend: function () {
                    //debugger;
                    //VerificaAutenticazione();
                    //$("#DialogNewDoc").dialog("destroy");
                    //$("#divEffettoLoadAutNoDoc").show("slow");
                    //$("#ContenitoreDipendentiGepe").empty();
                },
                success: function (result) {
                    //debugger;
                    //$("#divEffettoLoadAutNoDoc").hide("slow");
                    $("#tabFamiliari").empty();
                    $("#tabFamiliari").html(result);
                    //InfoTrasferimento(matricola);
                        //GestioneMenu();
                },
                complete: function () {
                    //MenuDaVisualizzare();
                },
                error: function (jqXHR, textStatus, errorThrow) {
                    //debugger;
                    var msg = errorThrow.err;
                    AlertDialog(msg);
                }

            });
        }
    }



</script>



