@using NewISE.Models.DBModel
@model IEnumerable<NewISE.Models.DBModel.UtentiAutorizzatiModel>
@{
    bool solaLettura = Convert.ToBoolean(ViewData["solaLettura"]);
    bool admin = Convert.ToBoolean(ViewBag.Amministratore);
}
@{
    ViewBag.Title = "Home";
}

<link href="~/Content/css/cssHome.css" rel="stylesheet" />
<input type="hidden" id="hAmministratore" value="@admin.ToString()" />

<div class="row">
    <div id="divPanelUtenzeDip" class="col-xs-12">
        @Html.Action("ElencoUtenzeDipendenti", "UtenzeDipendenti")
    </div>
</div>

<div class="modal fade" id="inviaUtenzeModal" tabindex="-1" role="dialog" aria-labelledby="inviaDocModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body alert alert-info text-info" style="font-size: 1em;">
                    <div id="viewUtenzeMail">
                        <img src="~/Immagini/Loading/ajax-loader (1).gif" />
                    </div>
                </div>
                <div class="modal-footer" style="background-color:white;text-align:center">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
                </div>
             </div>
        </div>
</div>


<div class="modal fade" id="inviaModificaModal" tabindex="-1" role="dialog" aria-labelledby="inviaModificaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-body alert alert-info text-info" style="font-size: 1em;">
                <div id="viewDocumentoModifica">
                    <img src="~/Immagini/Loading/ajax-loader (1).gif" />
                </div>
            </div>
            <div class="modal-footer" style="background-color:white;text-align:center">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
            </div>
        </div>
    </div>
</div>

<div id="dialog-confirm-Utenze" title="Conferma Eliminazione email?" class="hide">
    <p>
        <span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>Elimina email secondaria ?<br />
    </p>
</div>
<script type="text/javascript">
    function RicaricaDip()
    {
            //debugger;
        var rotta = "/UtenzeDipendenti/ElencoUtenzeDipendenti";
           
            $.ajax({
                url: rotta,
                type: "POST", //Le info testuali saranno passate in POST
                //data: { "idd": idd },
                dataType: 'html',
                async: false,
                beforeSend: function () {
                    // debugger;
                  //  $('#inviaDocModal').modal('show');
                    //Blocca();
                },
                success: function (result) {
                    // debugger;
                    $("#divPanelUtenzeDip").empty();
                    $("#divPanelUtenzeDip").html(result);
                },
                error: function (error) {
                    //debugger;
                    //Sblocca();
                    var msg = error.responseText;
                    //ErroreElaborazioneAjax(msg);
                }
            });
        
    }
    function EliminaEmail(idmail,idDipendente) {
        debugger;
        var rotta = "/UtenzeDipendenti/EliminaEmail";
        var idd = idDipendente;
           
        $('#dialog-confirm-Utenze').dialog({
            autoOpen: true,
            width: 400,
            buttons: [
                {
                    text: "OK",
                    click: function () {
                        $(this).dialog("close");
                        $.ajax({
                            type: "POST",
                            url: rotta,
                            data: { idEmailSec: idmail, idd: idd },
                            dataType: 'html',
                            beforeSend: function () {
                                //debugger;
                                //VerificaAutenticazione();
                                //$("#DialogNewDoc").dialog("destroy");
                                //$("#divEffettoLoadAutNoDoc").show("slow");

                            },
                            success: function (result) {
                             //   debugger;
                                //$("#divEffettoLoadAutNoDoc").hide("slow");
                               // alert(result);
                                                               
                                $("#viewUtenzeMail").empty();
                                $("#viewUtenzeMail").html(result);
                              //  $('#inviaUtenzeModal').modal('show');
                                //RicercaDocumenti();

                            },
                            complete: function () {
                                //$("#divEffettoLoadAutNoDoc").hide("slow");
                                //                $("#Centro").getNiceScroll().resize();
                            //    debugger;
                                ////$("#divEffettoLoadAutNoDoc").hide("slow");
                              
                            },
                            error: function (jqXHR, textStatus, errorThrow) {
                                //debugger;
                                var msg = errorThrow.err;
                                AlertDialog(msg);
                            }

                        });
                    },
                    "class": "ui-button-danger"
                },
                {
                    text: "Annulla",
                    click: function () {
                        $(this).dialog("close");
                    }
                }
            ]
        });

    }
</script>